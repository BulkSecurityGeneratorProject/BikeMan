<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">
    <changeSet author="jhipster" id="1402484105134-30">
        <createTable catalogName="" schemaName="public" tableName="T_ADDRESS">
            <column name="address_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="city" type="VARCHAR(255)"/>
            <column name="country" type="VARCHAR(255)"/>
            <column name="street_and_housenumber" type="VARCHAR(255)"/>
            <column name="zip" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-31">
        <createTable catalogName="" schemaName="public" tableName="T_CUSTOMER">
            <column name="birthday" type="date"/>
            <column name="card_id" type="VARCHAR(255)"/>
            <column name="card_pin" type="INT4"/>
            <column name="customer_id" type="VARCHAR(255)"/>
            <column name="first_name" type="VARCHAR(255)"/>
            <column name="in_transaction" type="BOOLEAN"/>
            <column name="is_activated" type="BOOLEAN"/>
            <column name="last_name" type="VARCHAR(255)"/>
            <column name="user_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="address_id" type="INT8"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-32">
        <createTable catalogName="" schemaName="public" tableName="T_MANAGER">
            <column name="user_id" type="INT8">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-33">
        <createTable catalogName="" schemaName="public" tableName="T_PEDELEC">
            <column name="pedelec_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="in_transaction" type="BOOLEAN"/>
            <column name="manufacturer_id" type="VARCHAR(255)"/>
            <column name="state" type="VARCHAR(255)"/>
            <column name="state_of_charge" type="FLOAT4"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-34">
        <createTable catalogName="" schemaName="public" tableName="T_STATION">
            <column name="station_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="location_latitude" type="NUMBER(24, 18)"/>
            <column name="location_longitude" type="NUMBER(24, 18)"/>
            <column name="manufacturer_id" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="note" type="CLOB"/>
            <column name="state" type="VARCHAR(255)"/>
            <column name="address_id" type="INT8"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-35">
        <createTable catalogName="" schemaName="public" tableName="T_STATION_SLOT">
            <column name="station_slot_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="is_occupied" type="BOOLEAN"/>
            <column name="manufacturer_id" type="VARCHAR(255)"/>
            <column name="state" type="VARCHAR(255)"/>
            <column name="station_slot_position" type="INT4"/>
            <column name="pedelec_id" type="INT8"/>
            <column name="station_id" type="INT8"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-36">
        <createTable catalogName="" schemaName="public" tableName="T_TRANSACTION">
            <column name="transaction_id" type="INT8">
                <constraints nullable="false"/>
            </column>
            <column name="end_datetime" type="timestamp"/>
            <column name="start_datetime" type="timestamp"/>
            <column name="user_id" type="INT8"/>
            <column name="from_slot_id" type="INT8"/>
            <column name="pedelec_id" type="INT8"/>
            <column name="to_slot_id" type="INT8"/>
        </createTable>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-37">
        <addColumn catalogName="" schemaName="public" tableName="T_USER">
            <column name="user_type" type="varchar(31)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-38">
        <addPrimaryKey catalogName="" columnNames="address_id" constraintName="T_ADDRESSPK" schemaName="public" tableName="T_ADDRESS"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-39">
        <addPrimaryKey catalogName="" columnNames="user_id" constraintName="T_CUSTOMERPK" schemaName="public" tableName="T_CUSTOMER"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-40">
        <addPrimaryKey catalogName="" columnNames="user_id" constraintName="T_MANAGERPK" schemaName="public" tableName="T_MANAGER"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-41">
        <addPrimaryKey catalogName="" columnNames="pedelec_id" constraintName="T_PEDELECPK" schemaName="public" tableName="T_PEDELEC"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-42">
        <addPrimaryKey catalogName="" columnNames="station_id" constraintName="T_STATIONPK" schemaName="public" tableName="T_STATION"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-43">
        <addPrimaryKey catalogName="" columnNames="station_slot_id" constraintName="T_STATION_SLOPK" schemaName="public" tableName="T_STATION_SLOT"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-44">
        <addPrimaryKey catalogName="" columnNames="transaction_id" constraintName="T_TRANSACTIONPK" schemaName="public" tableName="T_TRANSACTION"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-45">
        <addForeignKeyConstraint baseColumnNames="pedelec_id" baseTableCatalogName="" baseTableName="T_TRANSACTION" baseTableSchemaName="public" constraintName="FK_3vlrj8gl76aiikbebu8jjjil8" deferrable="false" initiallyDeferred="false" referencedColumnNames="pedelec_id" referencedTableCatalogName="" referencedTableName="T_PEDELEC" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-46">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableCatalogName="" baseTableName="T_CUSTOMER" baseTableSchemaName="public" constraintName="FK_9ibfn58xursjfsdei415t5j0r" deferrable="false" initiallyDeferred="false" referencedColumnNames="user_id" referencedTableCatalogName="" referencedTableName="T_USER" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-47">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableCatalogName="" baseTableName="T_TRANSACTION" baseTableSchemaName="public" constraintName="FK_eknl11x7ke9v1lbonnw3dnx5h" deferrable="false" initiallyDeferred="false" referencedColumnNames="user_id" referencedTableCatalogName="" referencedTableName="T_CUSTOMER" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-48">
        <addForeignKeyConstraint baseColumnNames="to_slot_id" baseTableCatalogName="" baseTableName="T_TRANSACTION" baseTableSchemaName="public" constraintName="FK_fm9359xne09h8exlrn83rquk1" deferrable="false" initiallyDeferred="false" referencedColumnNames="station_slot_id" referencedTableCatalogName="" referencedTableName="T_STATION_SLOT" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-49">
        <addForeignKeyConstraint baseColumnNames="address_id" baseTableCatalogName="" baseTableName="T_CUSTOMER" baseTableSchemaName="public" constraintName="FK_lcbxy0yb275b9urru0eqpxb5h" deferrable="false" initiallyDeferred="false" referencedColumnNames="address_id" referencedTableCatalogName="" referencedTableName="T_ADDRESS" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-50">
        <addForeignKeyConstraint baseColumnNames="pedelec_id" baseTableCatalogName="" baseTableName="T_STATION_SLOT" baseTableSchemaName="public" constraintName="FK_m461pdudqjo52j1pdk0n041nc" deferrable="false" initiallyDeferred="false" referencedColumnNames="pedelec_id" referencedTableCatalogName="" referencedTableName="T_PEDELEC" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-51">
        <addForeignKeyConstraint baseColumnNames="station_id" baseTableCatalogName="" baseTableName="T_STATION_SLOT" baseTableSchemaName="public" constraintName="FK_ontswc3cendmxvcpsopeeu2an" deferrable="false" initiallyDeferred="false" referencedColumnNames="station_id" referencedTableCatalogName="" referencedTableName="T_STATION" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-52">
        <addForeignKeyConstraint baseColumnNames="from_slot_id" baseTableCatalogName="" baseTableName="T_TRANSACTION" baseTableSchemaName="public" constraintName="FK_p9nwsp1g2e4m2vrrs5lr7wym4" deferrable="false" initiallyDeferred="false" referencedColumnNames="station_slot_id" referencedTableCatalogName="" referencedTableName="T_STATION_SLOT" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-53">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableCatalogName="" baseTableName="T_MANAGER" baseTableSchemaName="public" constraintName="FK_s9nqaht6e92xx2qwij4w6cbx6" deferrable="false" initiallyDeferred="false" referencedColumnNames="user_id" referencedTableCatalogName="" referencedTableName="T_USER" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-54">
        <addForeignKeyConstraint baseColumnNames="address_id" baseTableCatalogName="" baseTableName="T_STATION" baseTableSchemaName="public" constraintName="FK_ssq9hlkby7cdmaqt6dr0evxcu" deferrable="false" initiallyDeferred="false" referencedColumnNames="address_id" referencedTableCatalogName="" referencedTableName="T_ADDRESS" referencedTableSchemaName="public"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-55">
        <addUniqueConstraint catalogName="" columnNames="address_id" constraintName="UC_T_CUSTOMER_ADDRESS_ID" deferrable="false" disabled="false" initiallyDeferred="false" schemaName="public" tableName="T_CUSTOMER"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-56">
        <addUniqueConstraint catalogName="" columnNames="address_id" constraintName="UC_T_STATION_ADDRESS_ID" deferrable="false" disabled="false" initiallyDeferred="false" schemaName="public" tableName="T_STATION"/>
    </changeSet>
    <changeSet author="jhipster" id="1402484105134-57">
        <addUniqueConstraint catalogName="" columnNames="pedelec_id" constraintName="UC_T_STATION_SLOT_PEDELEC_ID" deferrable="false" disabled="false" initiallyDeferred="false" schemaName="public" tableName="T_STATION_SLOT"/>
    </changeSet>

    <changeSet author="jhipster" id="1402484105134-58">
        <createIndex indexName="idx_t_station_slot_station_id"
                     schemaName="public"
                     tableName="t_station_slot"
                     unique="false">
            <column name="station_id" type="INT8"/>
        </createIndex>
        <createIndex indexName="idx_t_transaction_user_id"
                     schemaName="public"
                     tableName="t_transaction"
                     unique="false">
            <column name="user_id" type="VARCHAR(255)"/>
        </createIndex>
        <createIndex indexName="idx_t_transaction_pedelec_id"
                     schemaName="public"
                     tableName="t_transaction"
                     unique="false">
            <column name="pedelec_id" type="INT8"/>
        </createIndex>
        <createIndex indexName="idx_t_transaction_from_slot_id"
                     schemaName="public"
                     tableName="t_transaction"
                     unique="false">
            <column name="from_slot_id" type="INT8"/>
        </createIndex>
        <createIndex indexName="idx_t_transaction_to_slot_id"
                     schemaName="public"
                     tableName="t_transaction"
                     unique="false">
            <column name="to_slot_id" type="INT8"/>
        </createIndex>
    </changeSet>

    <changeSet id="1399570790463-55" author="wollo">
        <loadData encoding="UTF-8"
                  file="config/liquibase/users.csv"
                  separator=";"
                  tableName="T_USER"/>

        <loadData encoding="UTF-8"
                  file="config/liquibase/customers.csv"
                  separator=";"
                  tableName="T_CUSTOMER"/>

        <loadData encoding="UTF-8"
                  file="config/liquibase/authorities.csv"
                  separator=";"
                  tableName="T_AUTHORITY"/>

        <loadData encoding="UTF-8"
                  file="config/liquibase/users_authorities.csv"
                  separator=";"
                  tableName="T_USER_AUTHORITY"/>
    </changeSet>

</databaseChangeLog>
